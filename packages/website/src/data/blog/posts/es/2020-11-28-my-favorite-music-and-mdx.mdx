**Spotify** acaba de hacer una playlist con mi TOP de canciones m√°s escuchadas en este 2020, as√≠ que aprovech√© para hacer un tutorial sobre [MDX](https://mdxjs.com/), [Next.js](https://nextjs.org) y [Tailwind CSS](https://tailwindcss.com).

> **MDX** es una extensi√≥n del lenguaje **Markdown**, haciendolo mucho m√°s potente y personalizable, ya que permite usar y renderizar **componentes React** dentro de archivos **Markdown** ü§Ø.

A continuaci√≥n, un ejemplo de un **componente de React** renderizado en este archivo **MDX**.

<Playground
  Component={() => (
    <HelloWorldMDX text="Hola, soy un componente React que usa Tailwind CSS para sus estilos" />
  )}
  code={DATA.blogPost.codeSnippets.ONE}
  language="tsx"
/>

## Configurando Next.js y MDX

Este sitio web lo constru√≠ usando **Next.js**, voy a hablar acerca de como configur√© **MDX** para crear la secci√≥n del blog. Para lograr esto, me fue de gran ayuda este [art√≠culo](https://sergiodxa.com/articles/using-mdx-with-remote-content) publicado por [Sergio Xalambr√≠](https://twitter.com/sergiodxa).

Entonces, primero configur√© **MDX** con **Next.js**. Aqu√≠ est√°n las [instrucciones](https://mdxjs.com/getting-started/next), realmente es muy f√°cil lograrlo.

Despu√©s, instal√© el paquete [next-mdx-remote](https://GITHUB_DATA.com/hashicorp/next-mdx-remote). Este paquete permite renderizar archivos **MDX** que pueden estar alojados en un sitio diferente al proyecto, por ejemplo un **CMS**, un **CDN**, una **base de datos** o cualquier otro lugar. Hay otras razones m√°s por las cuales es √∫til usar este paquete, en esta [secci√≥n de su repositorio de GitHub](https://GITHUB_DATA.com/hashicorp/next-mdx-remote#background--theory) puedes conocer m√°s acerca de los problemas que soluciona **next-mdx-remote**.

Ahora, explicar√© algunos de los pasos que realic√© para usar **next-mdx-remote** en la p√°gina de **Next.js** de mi sitio web que se encarga de cargar el contenido **MDX** de una publicaci√≥n de acuerdo a un par√°metro de URL (`/blog/[slug]`).

Primero, import√© algunas funciones de **next-mdx-remote**.

<Code
  language="typescript"
  sourceURL={DATA.GITHUB_DATA.monorepo.website.files["[slug]"]}
  code={DATA.blogPost.codeSnippets.TWO}
/>

Despu√©s, import√© los **componentes React** y las **variables** que se usar√°n dentro de los archivos **MDX**.

<Code
  language="typescript"
  sourceURL={DATA.GITHUB_DATA.monorepo.website.files["[slug]"]}
  code={DATA.blogPost.codeSnippets.THREE}
/>

Configur√© la funci√≥n `getStaticPaths` en donde la propiedad `paths` es un arreglo con los slugs de todos mis publicaciones que voy a **pre-renderizar** como p√°ginas. El listado de todos mis publicaciones est√°n definidos en un archivo <Link href={DATA.GITHUB_DATA.monorepo.website.files.posts}>JSON</Link> dentro del proyecto, pero esta informaci√≥n se podr√≠a leer de una **base de datos**, un **CMS**, una **API**, etc.

<Code
  language="typescript"
  sourceURL={DATA.GITHUB_DATA.monorepo.website.files["[slug]"]}
  code={DATA.blogPost.codeSnippets.FOUR}
/>

> La razon de configurar `fallback: false` es porque estoy usando **Static Generation**, por lo tanto todas las p√°ginas de este sitio web son **pre-renderizadas** en **tiempo de compilaci√≥n**, esto trae beneficios de rendimiento y velocidad de carga. Eleg√≠ **Static Generation** porque tengo muy pocas p√°ginas y publicaciones en este momento, en un futuro cuando este sitio web crezca, usar√© otra estrategia m√°s eficiente y que mejor se adapte a mi situaci√≥n. Les recomiendo leer la [documentaci√≥n de Next.js](https://nextjs.org/docs/basic-features/data-fetching) acerca de este tema, es muy clara su explicaci√≥n.

Ahora, en la funci√≥n `getStaticProps` se lee el contenido **MDX** de cada publicaci√≥n. Esta funci√≥n se ejecuta solo en el servidor. Por el momento tengo el contenido de las publicaciones dentro de mi proyecto, en un futuro podr√≠a alojarlos en un **CMS**, por ejemplo.

<Code
  sourceURL={DATA.GITHUB_DATA.monorepo.website.files["[slug]"]}
  language="typescript"
  code={DATA.blogPost.codeSnippets.FIVE}
/>

> **Problema:** Al usar **next-mdx-remote**, no puedo importar componentes o variables dentro de los archivos **MDX** usando `import`. En este [link](https://GITHUB_DATA.com/hashicorp/next-mdx-remote#caveats) puedes leer m√°s acerca de esto.

> **Soluci√≥n:** Tuve que pasar un objeto de configuraci√≥n cuando invoqu√© la funci√≥n `renderToString`. La propiedad `components` debe ser un objeto que contenga todos los **componentes React** que se usar√°n en los archivos **MDX**. La propiedad `scope` es un objeto en donde se puede guardar **variables** que se usar√°n en los archivos **MDX**.

Por √∫ltimo, este es el componente que renderiza una publicaci√≥n.

<Code
  sourceURL={DATA.GITHUB_DATA.monorepo.website.files["[slug]"]}
  language="tsx"
  code={DATA.blogPost.codeSnippets.SIX}
/>

> **Importante:** Es necesario que el valor de la propiedad `components` sea igual en `hydrate(content, { components: MDXComponents });` como en `await renderToString(content, { components: MDXComponents });`.

Para manejar los estilos **CSS** del contenido compilado de los archivos **MDX**, us√© al inicio este [plugin](https://tailwindcss.com/docs/typography-plugin) de [Tailwind CSS](https://tailwindcss.com), pero despu√©s lo dej√© de usar y decid√≠ construir un componente con mis propios estilos.

<Code
  sourceURL={DATA.GITHUB_DATA.monorepo.website.files.MDXContent}
  language="tsx"
  code={DATA.blogPost.codeSnippets.SEVEN}
/>

> La directiva `@apply` me permite usar los estilos de **Tailwind CSS** dentro de mis declaraciones de estilos que construyo usando [styled-jsx](https://GITHUB_DATA.com/vercel/styled-jsx).

El resaltado de s√≠ntaxis de c√≥digo fuente lo hice con [prism-react-renderer](https://GITHUB_DATA.com/FormidableLabs/prism-react-renderer).

<Code
  sourceURL={DATA.GITHUB_DATA.monorepo.website.files.Code}
  language="tsx"
  code={DATA.blogPost.codeSnippets.EIGHT}
/>

## Conclusi√≥n

Y bueno, esto fue todo, aqu√≠ comparto la URL del repositorio por si quieres ver con m√°s detalle la implementaci√≥n de este sitio web. Espero que esta publicaci√≥n te sirva para iniciar a trabajar con **MDX**.

<GitHubRepo
  name={DATA.GITHUB_DATA.monorepo.website.name}
  url={DATA.GITHUB_DATA.monorepo.website.url}
  description={DATA.GITHUB_DATA.monorepo.website.description}
/>

---

## Bonus üòÅ

No puedo terminar sin hablar acerca de la otra parte importante de esta publicaci√≥n, osea, la m√∫sica que m√°s escuch√© este a√±o. Mi idea inicial fue escribir el contenido de las publicaciones usando solamente **Markdown**, pero gracias a **MDX** pude combinar **Markdown** con **React** y de esta forma pude insertar un **Widget HTML** para mostrar la playlist de canciones que **Spotify** hizo para m√≠.

<SpotifyPlaylist />

Despu√©s de ver esta playlist me doy cuenta que:

1. [Par mil](https://www.youtube.com/watch?v=Gd37vIRhqSA) es una de mis canciones favoritas y que m√°s disfruto tocar en la guitarra.
1. Me gusta mucho [Divididos](https://www.youtube.com/watch?v=7OlzxfSKjtI) y especialmente sus canciones de folclore.
1. Este a√±o descubr√≠ mucha m√∫sica de [Pedro Aznar](https://www.youtube.com/watch?v=MDSxcA389DE), me parece un m√∫sico incre√≠ble.
1. [Parque Acu√°tico](https://www.youtube.com/watch?v=Ffkl2rOQEMg) me parece una canci√≥n muy buena y la escuch√© mucho en la cuarentena.
1. Me asombra no ver canciones del album [Artaud](https://www.youtube.com/watch?v=Tk23kQRFWcw&list=PLL0BXIloA_5y3uX2UO0ktpQtUcuc2zGj-) de [Spinetta](https://www.youtube.com/watch?v=hEL2AgzRmjc) en el TOP 10 de esta playlist, porque escuch√© muchas veces ese album y es uno de mis favoritos.
1. Descubr√≠ a [LosPetitFellas](https://www.youtube.com/watch?v=u9zWGJ-xNlE), esta [canci√≥n](https://www.youtube.com/watch?v=iX2kyzuJ4ck) es una delicia.
1. Definitivamente me gusta mucho la m√∫sica de [Argentina](https://www.youtube.com/watch?v=7YIkurDaHpc), es la que m√°s escucho en mi d√≠a a d√≠a.

Hasta la pr√≥xima ‚úåÔ∏è
